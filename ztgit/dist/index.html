<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>激活码生成器</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI','Microsoft YaHei',Arial,sans-serif;background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px}
    .container{background:rgba(255,255,255,.08);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-radius:20px;border:1px solid rgba(255,255,255,.18);box-shadow:0 15px 35px rgba(0,0,0,.5);padding:40px;width:100%;max-width:600px}
    h1{color:#e0e0ff;text-align:center;margin-bottom:30px;font-size:32px;font-weight:600;letter-spacing:1px;text-shadow:0 0 10px rgba(224,224,255,.5)}
    .form-group{margin-bottom:25px}label{display:block;color:#c0c0ff;margin-bottom:10px;font-weight:500;font-size:16px}
    input[type=text]{width:100%;padding:14px;background:rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.15);border-radius:10px;color:#fff;font-size:16px;transition:all .3s ease}
    input[type=text]:focus{outline:none;border-color:#6a67ce;box-shadow:0 0 0 3px rgba(106,103,206,.3)}
    .version-selector{display:flex;gap:20px;margin-bottom:25px}.version-option{flex:1;position:relative}.version-option input[type=radio]{position:absolute;opacity:0}
    .version-label{display:block;padding:15px;background:rgba(0,0,0,.3);border:1px solid rgba(255,255,255,.15);border-radius:10px;text-align:center;cursor:pointer;transition:all .3s ease;color:#c0c0ff;font-weight:500}
    .version-option input[type=radio]:checked+.version-label{background:linear-gradient(135deg,#6a67ce,#4a47a3);color:#fff;border-color:rgba(255,255,255,.3);box-shadow:0 0 15px rgba(106,103,206,.5)}
    .version-label:hover{border-color:#6a67ce;transform:translateY(-2px)}
    button{width:100%;padding:16px;background:linear-gradient(135deg,#6a67ce,#4a47a3);color:#fff;border:none;border-radius:10px;font-size:18px;font-weight:600;cursor:pointer;transition:all .3s ease;margin-top:10px;letter-spacing:.5px;box-shadow:0 5px 15px rgba(0,0,0,.3)}
    button:hover{transform:translateY(-3px);box-shadow:0 8px 20px rgba(106,103,206,.6)}
    .result{margin-top:30px;padding:20px;background:rgba(0,0,0,.3);border-radius:10px;border:1px solid rgba(255,255,255,.1);word-break:break-all;display:none;backdrop-filter:blur(5px);-webkit-backdrop-filter:blur(5px)}
    .result h3{color:#e0e0ff;margin-bottom:10px;font-size:18px}
    .result pre{color:#fff;font-size:14px;line-height:1.6;white-space:pre-wrap}
    .copy-button{margin-top:10px;padding:10px 20px;background:rgba(255,255,255,.1);color:#e0e0ff;border:1px solid rgba(255,255,255,.2);border-radius:5px;cursor:pointer;font-size:14px;transition:all .3s ease}
    .copy-button:hover{background:rgba(106,103,206,.3);border-color:#6a67ce}
    .error{color:#ff9e9e;margin-top:10px;padding:10px;background:rgba(255,0,0,.15);border-radius:5px;border-left:3px solid #ff6b6b;display:none}
  </style>
</head>
<body>
  <div class="container">
    <h1>激活码生成器</h1>

    <div class="form-group">
      <label>用户身份标识符：</label>
      <input id="uid" type="text" placeholder="请输入用户身份标识符">
    </div>

    <div class="form-group">
      <label>选择激活版本：</label>
      <div class="version-selector">
        <div class="version-option">
          <input value="professional" id="professional" name="version" type="radio" checked>
          <label for="professional" class="version-label">专业版</label>
        </div>
        <div class="version-option">
          <input value="premium" id="premium" name="version" type="radio">
          <label for="premium" class="version-label">尊享版</label>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label>有效期：</label>
      <input id="validity" type="text" placeholder="请输入数字（天）或'永久'">
    </div>

    <button onclick="generate()">生成激活码</button>

    <div id="error" class="error"></div>

    <div id="result" class="result">
      <h3>生成的激活码：</h3>
      <pre id="code"></pre>
      <button class="copy-button" onclick="copy()">复制到剪贴板</button>
    </div>
  </div>

  <script>
    async function generate(){
      const uid      = document.getElementById('uid').value.trim()
      const validity = document.getElementById('validity').value.trim()
      const version  = document.querySelector('input[name="version"]:checked').value
      const errorDiv = document.getElementById('error')
      const resultDiv= document.getElementById('result')
      errorDiv.style.display='none'
      resultDiv.style.display='none'
      if(!uid || !validity) return showError('请完整填写信息')
      if(!/^\d+$/.test(validity) && validity!=='永久') return showError('有效期只能是数字（天）或"永久"')

      const res = await fetch('/api/sign',{
        method:'POST',
        headers:{'content-type':'application/json'},
        body: JSON.stringify({uid, validity, version})
      })
      if(!res.ok) return showError(await res.text())
      const obj = await res.json()
      document.getElementById('code').textContent = JSON.stringify(obj, null, 2)
      resultDiv.style.display='block'
    }
    function showError(msg){
      const err=document.getElementById('error')
      err.textContent=msg; err.style.display='block'
    }
    function copy(){
      const txt=document.getElementById('code').textContent
      navigator.clipboard.writeText(txt).then(()=>alert('已复制'))
    }
  </script>
</body>
</html>